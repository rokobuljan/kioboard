var t,e,s,i=Object.defineProperty,n=t=>{throw TypeError(t)},a=(t,e,s)=>((t,e,s)=>e in t?i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s),h=(t,e,s)=>(((t,e,s)=>{e.has(t)||n("Cannot "+s)})(t,e,"access private method"),s);import o from"https://unpkg.com/@highlightjs/cdn-assets@11.9.0/es/highlight.min.js";import r from"https://unpkg.com/@highlightjs/cdn-assets@11.9.0/es/languages/javascript.min.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}(),o.registerLanguage("javascript",r),window.hljs=o,document.addEventListener("DOMContentLoaded",(t=>{document.querySelectorAll("pre code").forEach((t=>{o.highlightElement(t)}))}));class l{constructor(){this.events=new Map}on(t,e){var s;return this.events.has(t)||this.empty(t),null==(s=this.events.get(t))||s.add(e),this}once(t,e){const s=(...i)=>{e(...i),this.off(t,s)};return this.on(t,s),this}off(t,e){return this.events.has(t)?(e?this.events.get(t).delete(e):this.empty(t),0===this.events.get(t).size&&this.events.delete(t),this):this}empty(t){return this.events.set(t,new Set),this}emit(...t){return t.forEach((t=>{this.events.has(t)&&this.events.get(t).forEach((e=>{e(t)}))})),this}get(){return this.events}}const d=(t,e=document)=>e.querySelectorAll(t),c=(t,e)=>Object.assign(document.createElement(t),e),u=t=>(Array.isArray(t)||(t=t.trim().split(/ +/g)),t),m=class i{constructor(e){var s,i,h;s=this,(i=t).has(s)?n("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(s):i.set(s,h),a(this,"_dragOffset",{x:0,y:0}),this.parent="body",this.element=c("div",{className:"kioboard"}),this.inputs="[data-kioboard]",this.layerNameInitial="default",this.layerName=this.layerNameInitial,this.layerNameDefault="default",this.layerNameShift="shift",this.layoutName="",this.layout,this.theme="default",this.isEnterSubmit=!0,this.classVisible="is-visible",this.classShift="is-shift",this.classCaps="is-caps",this.isVisible=!1,this.isPermanent=!1,this.isScroll=!0,this.scrollOptions={behavior:"smooth",block:"start",inline:"nearest"},this.shiftState=0,this.key="",this.pointerId=-1,this.onInit=()=>{},this.onLoad=()=>{},this.onBeforeShow=()=>{},this.onShow=()=>{},this.onBeforeHide=()=>{},this.onHide=()=>{},this.onKeyDown=(t="")=>{},this.onKeyUp=(t="")=>{},Object.assign(this,e),"string"==typeof this.parent&&(this.parent=((t,e=document)=>e.querySelector(t))(this.parent)),"string"==typeof this.inputs&&(this.inputs=d(this.inputs)),this.inputs="length"in this.inputs?[...this.inputs]:[this.inputs],this.input=this.inputs[0],this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleShow=this.handleShow.bind(this),this.handleHide=this.handleHide.bind(this),this.init()}load(t,e){if("string"==typeof t)try{import(t).then((({default:t})=>{this.setLayout(t),null==e||e.call(this,t),this.onLoad()}))}catch(s){console.error("Kioboard",s)}else this.setLayout(t),null==e||e.call(this,t),this.onLoad();return this}setLayout(t){return t?(this.layout=t,this.layout.icons={...i.commonIcons,...this.layout.icons},this.setActions(t.actions),this.layoutName=t.name??"unnamed",this.changeLayer(),this):(console.warn("Kioboard: no layout provided"),this)}setActions(t={}){return this.emitter=new l,Object.entries({...i.commonActions,...t}).forEach((([t,e])=>{this.on(t,e)})),this}setStyle(t){return Object.entries(t).forEach((([t,e])=>{this.element.style.setProperty(`--${t}`,e)})),this}on(t,e){return"function"!=typeof e||u(t).forEach((t=>{var s;null==(s=this.emitter)||s.on(t,e)})),this}off(t,e){return u(t).forEach((t=>{var s;null==(s=this.emitter)||s.off(t,e)})),this}emit(t){return t?(u(t).forEach((t=>{var e,s;this.key=t,(null==(e=this.emitter)?void 0:e.events.has(this.key))?this.emitter.events.get(this.key).forEach((t=>{if("function"!=typeof t)return;const e=t.call(this,this.key,this);"string"==typeof e&&this.insert(e)})):this.insert(this.key);d(`[data-kioboard-key="${this.key}"]`,this.element).forEach((t=>{t.classList.remove("is-active"),requestAnimationFrame((()=>{t.classList.add("is-active")}))})),null==(s=this.input)||s.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0}))})),this):this}sequence(t,e=100,s=()=>{}){t=[...u(t)];let i=null;const n=()=>{if(0===t.length)return void s.call(this,t);const a=t.shift();this.emit(`${a}`),this.onKeyDown(a),i=setTimeout((()=>{n()}),e)};return n(),()=>{clearTimeout(i)}}clearKioboard(){return this.element.innerHTML="",this}draw(){var t,e,s;return this.clearKioboard(),null==(s=null==(e=null==(t=this.layout)?void 0:t.layers)?void 0:e[this.layerName])||s.forEach(((t,e)=>{const s=c("div");s.dataset.kioboardRow=String(e),u(t).forEach((t=>{var e,i;const n=(null==(i=null==(e=this.layout)?void 0:e.icons)?void 0:i.hasOwnProperty(t))?this.layout.icons[t]:t,a=c("button",{innerHTML:`<span class="kioboard-icon">${n}</span>`});a.dataset.kioboardKey=t,s.append(a)})),this.element.append(s)})),this}shift(t){return void 0===t?(this.shiftState??(this.shiftState=0),this.shiftState+=1,this.shiftState%=3):this.shiftState=t,this}changeLayer(t=this.layerNameInitial){var e,s,i;return this.layout?(null==(s=null==(e=this.layout)?void 0:e.layers)?void 0:s.hasOwnProperty(t))?(t!==this.layerNameShift&&this.shift(0),t===this.layerNameDefault&&this.shiftState>0?t=this.layerNameShift:t===this.layerNameShift&&(t=this.shiftState>0?this.layerNameShift:this.layerNameDefault),this.layerName=t,this.element.dataset.kioboardLayout=this.layout.name,this.element.dataset.kioboardLayer=this.layerName,this.element.dataset.kioboardTheme=this.theme,this.element.classList.toggle(this.classShift,1===this.shiftState),this.element.classList.toggle(this.classCaps,2===this.shiftState),this.draw(),this):(console.error(`Kioboard: Layer "${t}" not found in layout "${null==(i=this.layout)?void 0:i.name}"`),this):(console.error("Kioboard: Layout not found. Load one first."),this)}setTheme(t){return this.theme=t,this.element.dataset.kioboardTheme=this.theme,this}show(t){return t&&this.changeLayer(t),this.onBeforeShow(),this.element.classList.add(this.classVisible),this.isScroll&&this.input.scrollIntoView(this.scrollOptions),addEventListener("pointerdown",this.handleHide,{capture:!0}),this.isVisible=!0,this.onShow(),this}hide(){return this.isPermanent||(this.onBeforeHide(),this.element.classList.remove(this.classVisible),removeEventListener("pointerdown",this.handleHide,{capture:!0}),this.isVisible=!1,this.onHide()),this}handleShow(t){this.input=t.target,this.input.disabled||(this.isVisible||this.isPermanent||this.changeLayer(this.layerNameInitial),this.show())}handleHide(t){const e=t.target.closest("[data-kioboard-key]"),s=this.element.contains(e);if(t.target.closest(".kioboard")===this.element||s)return;this.inputs.includes(t.target)||this.hide()}handleKeyDown(s){if(this.pointerId>-1)return;this.pointerId=s.pointerId;const i=s.target.closest("[data-kioboard-key]");if(!this.element.contains(i))return;s.preventDefault(),this.element.setPointerCapture(s.pointerId);const n=i.dataset.kioboardKey;this.emit(n),h(this,t,e).call(this,n),1!==this.shiftState||["shift","close"].includes(n)||this.shift(0).show(this.layerNameDefault),this.input.dispatchEvent(new KeyboardEvent("keydown",{key:n})),this.onKeyDown(n)}handleKeyUp(e){if(e.pointerId!==this.pointerId)return;this.element.releasePointerCapture(e.pointerId),this.pointerId=-1,h(this,t,s).call(this);const i=e.target.closest("[data-kioboard-key]");if(!i)return;const n=i.dataset.kioboardKey;this.input.dispatchEvent(new KeyboardEvent("keyup",{key:n})),this.onKeyUp(n)}hasSelection(){return this.input.selectionEnd-this.input.selectionStart>0}setRange(t,e,s){return this.input.setSelectionRange(e+t.length,s+t.length),this}insert(t="",e=this.input.selectionStart,s=this.input.selectionEnd){e=Math.max(0,e);let i=this.input.value.substring(0,e)+t+this.input.value.substring(s,this.input.value.length);const n=this.input.getAttribute("maxlength");return n&&i.length>Number(n)&&(i=i.substring(0,Number(n))),this.input.value=i,this.input.focus(),this.setRange(t,e,e),this}_preventDefault(t){t.preventDefault()}drag(){this.element.classList.add("kioboard-moving");const t=t=>{t.preventDefault(),this._dragOffset.x+=t.movementX,this._dragOffset.y+=t.movementY,this.element.style.translate=`${this._dragOffset.x}px ${this._dragOffset.y}px`};return addEventListener("pointermove",t),addEventListener("pointerup",(()=>{removeEventListener("pointermove",t),this.element.classList.remove("kioboard-dragging")})),this}init(){var t;return null==(t=this.parent)||t.append(this.element),this.inputs.forEach((t=>t.addEventListener("pointerdown",this.handleShow))),this.element.addEventListener("pointerdown",this.handleKeyDown),this.element.addEventListener("pointerup",this.handleKeyUp),this.element.addEventListener("pointercancel",this.handleKeyUp),this.element.addEventListener("contextmenu",this._preventDefault),this.shift(this.shiftState),this.layout&&this.load(this.layout),(this.isVisible||this.isPermanent)&&this.show(),this.onInit(),this}destroy(){return this.inputs.forEach((t=>{t.removeEventListener("pointerdown",this.handleShow)})),this.element.removeEventListener("pointerdown",this.handleKeyDown),this.element.removeEventListener("pointerup",this.handleKeyUp),this.element.removeEventListener("pointercancel",this.handleKeyUp),this.element.removeEventListener("contextmenu",this._preventDefault),this.element.remove(),this}};t=new WeakSet,e=function(s){["shift","drag"].includes(s)||(this.heldTimeout=setTimeout((()=>{this.emit(s),h(this,t,e).call(this,s)}),this.heldTimeout?100:1e3))},s=function(){clearTimeout(this.heldTimeout),this.heldTimeout=null},a(m,"commonActions",{default(){this.show("default")},shift(){this.shift().show("shift")},space:()=>" ",enter(){var t;"TEXTAREA"===this.input.tagName?this.insert("\r"):(this.hide(),this.isEnterSubmit&&(null==(t=this.input.form)||t.submit()))},backspace(){const t=this.input.selectionStart-(this.hasSelection()?0:1);this.insert("",t)},delete(){this.insert("",this.input.selectionStart,this.input.selectionEnd+(this.hasSelection()?0:1))},arrowLeft(){const t=this.input.selectionStart-(this.hasSelection()?0:1);this.insert("",t,t)},arrowRight(){const t=this.input.selectionEnd+(this.hasSelection()?0:1);this.insert("",t,t)},tab:()=>"\t",close(){this.hide()},drag(){this.drag()}}),a(m,"commonIcons",{space:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M8,28H40V20H37v5H11V20H8v8Z"/></svg>',tab:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path style="fill-rule: evenodd;" d="M4,18H24V8L43,24,24,40V30H4V18Zm3,3H27V15l11,9L27,33V27H7V21ZM45,38H42V10h3V38Z"/></svg>',arrowLeft:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path style="fill-rule:evenodd;" d="M32,8L12,24,32,40V8ZM17,24l12,9V15Z"/></svg>',arrowRight:'<svg xmlns="http://www.w3.org/2000/svg" transform="scale(-1,1)" viewBox="0 0 48 48"><path style="fill-rule:evenodd;" d="M32,8L12,24,32,40V8ZM17,24l12,9V15Z"/></svg>',delete:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M12.9,15.616H7.269V32.043H12.9a9.471,9.471,0,0,0,4.467-1.012,7.193,7.193,0,0,0,2.978-2.86,8.59,8.59,0,0,0,1.05-4.319,8.722,8.722,0,0,0-1.05-4.342,7.155,7.155,0,0,0-2.978-2.883A9.476,9.476,0,0,0,12.9,15.616h0ZM12.786,29.243H10.5V18.393h2.285a5.176,5.176,0,0,1,3.924,1.447A5.567,5.567,0,0,1,18.1,23.853a5.44,5.44,0,0,1-1.385,3.977,5.248,5.248,0,0,1-3.924,1.412h0Zm22.923-4a6.98,6.98,0,0,0-.8-3.377,5.582,5.582,0,0,0-2.239-2.271,7.14,7.14,0,0,0-6.614.023A5.7,5.7,0,0,0,23.8,21.97a7.5,7.5,0,0,0-.808,3.554,7.36,7.36,0,0,0,.82,3.53,5.822,5.822,0,0,0,2.285,2.365,6.568,6.568,0,0,0,3.313.836,6.118,6.118,0,0,0,3.855-1.212,5.94,5.94,0,0,0,2.124-3.095H31.9a2.634,2.634,0,0,1-2.562,1.577,2.956,2.956,0,0,1-2.1-.8,3.268,3.268,0,0,1-.97-2.212h9.349a7.954,7.954,0,0,0,.092-1.271h0ZM26.291,24.3a3.282,3.282,0,0,1,1-2.059,2.9,2.9,0,0,1,2.02-.741,3.154,3.154,0,0,1,2.147.765,2.636,2.636,0,0,1,.9,2.036H26.291Zm11.773-9.673V32.043H41.3V14.627H38.064Z"/></svg>',default:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path style="fill-rule: evenodd;" d="M8,10V35H19l5,5,5-5H40V10H8Zm3,3V32H21l3,3,3-3H37V13H11Zm4,3h3v3H15V16Zm5,0h3v3H20V16Zm5,0h3v3H25V16Zm5,0h3v3H30V16ZM15,21h3v3H15V21Zm5,0h3v3H20V21Zm5,0h3v3H25V21ZM15,26H33v3H15V26Zm15-5h3v3H30V21Z"/></svg>',backspace:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path style="fill-rule:evenodd;" d="M6,24L16,8H40V40H16Zm4,0,8-13H37V37H18Zm10-6h2l4,4,4-4h2v2l-4,4,4,4v2H30l-4-4-4,4H20V28l4-4-4-4V18Z"/></svg>',shift:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M30,28v9H18V28H8L24,8,40,28H30ZM14,25h7v9h6V25h7L24,13Z"/></svg>',enter:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path style="fill-rule:evenodd;" d="M21,8V18H32V11H44V30H21V40L2,24Zm14,6h6V27H18v6L7,24l11-9v6H35V14Z"/></svg>',close:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M38.849,36.021l-2.828,2.828L24,26.828,11.979,38.849,9.151,36.021,21.172,24,9.151,11.979l2.828-2.828L24,21.172,36.021,9.151l2.828,2.828L26.828,24Z"/></svg>',drag:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M24,18.443A5.557,5.557,0,1,1,18.443,24,5.557,5.557,0,0,1,24,18.443ZM16,12H32L24,4ZM32,36H16l8,8Zm4-20V32l8-8ZM12,32V16L4,24Z"/></svg>'});let p=m;const v={emoji:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><path style="fill-rule: evenodd;" d="M24,6A18,18,0,1,1,6,24,18,18,0,0,1,24,6Zm0,3A15,15,0,1,1,9,24,15,15,0,0,1,24,9ZM15,28a11.25,11.25,0,0,0,18,0l-0.6-1.5A30.548,30.548,0,0,1,24,28a30.548,30.548,0,0,1-8.4-1.5Zm3-11a3,3,0,1,1-3,3A3,3,0,0,1,18,17Zm12,0a3,3,0,1,1-3,3A3,3,0,0,1,30,17Z"/></svg>'},f={name:"en",layers:{default:["drag 1 2 3 4 5 6 7 8 9 0 backspace delete close","q w e r t y u i o p -","tab a s d f g h j k l enter","shift z x c v b n m , . @ .com","emoji numpad space arrowLeft arrowRight"],shift:["drag ! # $ % & * ( ) + ? backspace delete close","Q W E R T Y U I O P _","tab A S D F G H J K L enter","shift Z X C V B N M ; : @ .com","emoji numpad space arrowLeft arrowRight"],...{emoji:["🙂 😀 😁 😂 😄 😉 😊 😋 😎 🤓","😘 😍 🥰 🥲 🤗 🤩 🤔 🤨 😐 😑","😶 🙄 😏 😣 😥 😮 😯 😫 🥱 ☹️","😖 😞 😢 😭 😦 😩 🤯 😇 🤫 🤭","default backspace enter"]},...{numpad:["1 2 3","4 5 6","7 8 9","backspace 0 enter","default"]}},actions:{...{emoji(){this.show("emoji")}},...{numpad(){this.show("numpad")}}},icons:{...v,...{numpad:'<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><path id="_123" data-name="123" class="cls-1" d="M10.635,18.922V33.043h3.324V15.886H8.4v3.036h2.239ZM16.96,30.36v2.448h11.4v-2.73h-6.81q2.008-1.741,3.255-2.977a13.843,13.843,0,0,0,2.216-2.907,6.885,6.885,0,0,0,.97-3.507,5.108,5.108,0,0,0-1.408-3.754,5.432,5.432,0,0,0-4.04-1.424,5.563,5.563,0,0,0-3.959,1.459,5.866,5.866,0,0,0-1.651,4.284h3.139a3.481,3.481,0,0,1,.646-2.153A2.134,2.134,0,0,1,22.5,18.31a2.071,2.071,0,0,1,1.708.683,2.907,2.907,0,0,1,.554,1.883,4.951,4.951,0,0,1-.877,2.683,14.5,14.5,0,0,1-2.193,2.624q-1.316,1.259-3.532,3.142ZM30.442,20.4H33.6a2.444,2.444,0,0,1,.681-1.518,2.238,2.238,0,0,1,1.674-.6,2.356,2.356,0,0,1,1.7.565,2.083,2.083,0,0,1,.589,1.577q0,2.236-3.278,2.236H34.3v2.707h0.67a4.82,4.82,0,0,1,2.724.612,2.293,2.293,0,0,1,.877,2.024,2.414,2.414,0,0,1-.635,1.73,2.376,2.376,0,0,1-1.812.671,2.772,2.772,0,0,1-2-.694,2.586,2.586,0,0,1-.773-1.848H30.211a5.057,5.057,0,0,0,1.731,3.954,6.489,6.489,0,0,0,4.248,1.342,6.515,6.515,0,0,0,2.966-.624,4.352,4.352,0,0,0,1.87-1.73,4.969,4.969,0,0,0,.635-2.518,4.773,4.773,0,0,0-.75-2.777,3.885,3.885,0,0,0-2.089-1.506V23.912a3.685,3.685,0,0,0,1.789-1.377,4.126,4.126,0,0,0,.75-2.506,4.435,4.435,0,0,0-.612-2.318,4.266,4.266,0,0,0-1.812-1.624,6.394,6.394,0,0,0-2.886-.6,5.946,5.946,0,0,0-3.982,1.283A4.838,4.838,0,0,0,30.442,20.4h0Z"/></svg>'}}},g=(t,e=document)=>e.querySelector(t),y=(t,e=document)=>e.querySelectorAll(t),w=g("#char"),b=t=>{if(t.codePointAt(1))return;const e=(s="div",i={className:"ch",textContent:t},Object.assign(document.createElement(s),i));var s,i;w.append(e),e.classList.add("is-visible"),e.addEventListener("animationend",(()=>e.remove()))},L={name:"custom",layers:{default:["1 2 3 4","shift a b enter","smile space"],shift:["! ? . ,","shift A B enter","smile space"],emoji:["😀 🤓 🤭 😁","🥰 🙂 😎 enter","default space"]},icons:{smile:"😀"},actions:{smile(){this.show("emoji")}}},k=new p({parent:"#kioboard",theme:"flat-dark",isScroll:!1,isVisible:!0,onKeyDown(t){b(t)}});k.load(f);let E=null;const H=()=>{k.input.value="",E=k.sequence("shift K shift shift i o b o a r d",500,(()=>{H(),b(k.key)}))};H(),addEventListener("pointerdown",(()=>{E()}),{once:!0});const S=y("[data-kio-style]"),V=g('[data-kio-code="styles"]'),Z=()=>{const t="kio.setStyles({\n"+[...S].reduce(((t,e)=>t+=`  ${e.dataset.kioStyle}: "${e.value}",\n`),"")+"});";delete V.dataset.highlighted,V.textContent=t,hljs.highlightElement(V)};S.forEach((t=>{t.addEventListener("input",(t=>{t.preventDefault();const e=t.currentTarget.dataset.kioStyle,s=t.currentTarget.value;k.setStyle({[e]:s}),Z(),k.show()}))})),Z();const x=y("[data-kio-theme]"),M=g('[data-kio-code="theme"]'),A=t=>{delete M.dataset.highlighted,M.textContent=`kio.setTheme("${t}")`,hljs.highlightElement(M)};x.forEach((t=>{t.addEventListener("input",(t=>{const e=t.currentTarget.value;k.setTheme(t.currentTarget.value).show(),A(k.theme??"default"),x.forEach((t=>t.value=e))}))})),A("default");const K=y("[data-kio-layout]");K.forEach((t=>{t.addEventListener("click",(()=>{K.forEach((t=>t.classList.remove("is-active"))),t.classList.add("is-active"),k.load(`./layouts/${t.dataset.kioLayout}.js`).show()}))})),y("[data-kioboard]").forEach((t=>{t.addEventListener("pointerdown",(()=>{k.layout!==L&&"kio-layout-custom"===k.input.id?k.load(L):k.layout===L&&"kio-layout-custom"!==k.input.id&&k.load(f)}))})),y("input, textarea").forEach((t=>{t.setAttribute("autocomplete","off"),t.setAttribute("autocorrect","off"),t.setAttribute("autocapitalize","off"),t.setAttribute("spellcheck",!1)}));
